
CREATE DATABASE IF NOT EXISTS BBSUniversal CHARACTER SET utf8;

CREATE TABLE IF NOT EXISTS config (
	id INTEGER UNSIGNED AUTOINCREMENT PRIMARY KEY,
	absolute_path VARCHAR(255) DEFAULT '.',
	bbs_name VARCHAR(255) DEFAULT 'files/bbs_name',
	greeting VARCHAR(255) DEFAULT 'files/greeting',
	logout VARCHAR(255) DEFAULT 'files/logout',
	sys_info VARCHAR(255) DEFAULT 'files/sys_info',
	policy VARCHAR(255) DEFAULT 'files/policy',
	main_menu VARCHAR(255) DEFAULT 'files/main',
	user_info VARCHAR(255) DEFAULT 'files/user_info',
	threads SMALLINT UNSIGNED DEFAULT 2,
	timeout SMALLINT UNSIGNED DEFAULT 10,
	connect_mode TINYINT NOT NULL,
);

CREATE TABLE IF NOT EXISTS modes (
    id TINYINT UNSIGNED AUTOINCREMENT PRIMARY KEY,
	mode VARCHAR(8) NOT NULL,
);

INSERT INTO modes (mode) VALUES ('ASCII');
INSERT INTO modes (mode) VALUES ('ATASCII');
INSERT INTO modes (mode) VALUES ('PETSCII');
INSERT INTO modes (mode) VALUES ('VT102');

CREATE TABLE IF NOT EXISTS translations (
	id INTEGER UNSIGNED AUTOINCREMENT PRIMARY KEY,
	mode VARCHAR(8) NOT NULL,
	name VARCHAR(255) NOT NULL,
	output BLOB
);

CREATE TABLE IF NOT EXISTS users (
	id INTEGER UNSIGNED AUTOINCREMENT PRIMARY KEY,
	username VARCHAR(255) NOT NULL,
	password VARCHAR(255) PASSWORD,
	given VARCHAR(255) NOT NULL,
	family VARCHAR(255) NOT NULL,
	birthday DATE NOT NULL,
	location VARCHAR(255) NOT NULL,
	retro_systems SMALLTEXT,
	login_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
	logout_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
	mode TINYINT UNSIGNED NOT NULL,
	permissions INTEGER UNSIGNED NOT NULL
);

CREATE TABLE IF NOT EXISTS permissions (
	id INTEGER UNSIGNED AUTOINCREMENT PRIMARY KEY,
	view_files BOOLEAN DEFAULT FALSE,
	post_files BOOLEAN DEFAULT FALSE,
	download_files BOOLEAN DEFAULT FALSE,
	remove_files BOOLEAN DEFAULT FALSE,
	read_message BOOLEAN DEFAULT FALSE,
	post_message BOOLEAN DEFAULT FALSE,
	remove_message BOOLEAN DEFAULT FALSE,
	sysop BOOLEAN DEFAULT FALSE,
	timeout SMALLINT UNSIGNED DEFAULT 10
);

CREATE TABLE IF NOT EXISTS message_categories (
	id INTEGER UNSIGNED AUTOINCREMENT PRIMARY KEY,
	name VARCHAR(255) NOT NULL,
	description TEXT NOT NULL
);

CREATE TABLE IF NOT EXISTS nessages (
	id INTEGER UNSIGNED AUTOINCREMENT PRIMARY KEY,
	from_id INTEGER UNSIGNED NOT NULL,
	title VARCHAR(255) NOT NULL,
	message TEXT NOT NULL,
	hidden BOOLEAN DEFAULT FALSE,
	created TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS file_categories (
	id INTEGER UNSIGNED AUTOINCREMENT PRIMARY KEY,
	title VARACHAR(255) NOT NULL,
	description TEXT
);

CREATE TABLE IF NOT EXISTS files (
	id INTEGER UNSIGNED AUTOINCREMENT PRIMARY KEY,
	filename VARCHAR(255) NOT NULL,
	title VARCHAR(255) NOT NULL,
	category INTEGER UNSIGNED NOT NULL,
	file_type SMALLINT NOT NULL,
	description MEDIUMTEXT NOT NULL,
	file_size BIGINT UNSIGNED NOT NULL,
	uploaded TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
	endorsement INTEGER UNSIGNED DEFAULT 0
);

CREATE TABLE IF NOT EXISTS file_types (
    id SMALLINT NOT NULL AUTOINCREMENT PRIMARY KEY,
	type VARCHAR(255),
	extension VARCHAR(5),
);

INSERT INTO file_types (type, extension) VALUES ('Plain Text','TXT');
INSERT INTO file_types (type, extension) VALUES ('ASCII Text','ASC');
INSERT INTO file_types (type, extension) VALUES ('Atari ATASCII Text','ATA');
INSERT INTO file_types (type, extension) VALUES ('Commodore PETSCII Text','PET');
INSERT INTO file_types (type, extension) VALUES ('DEC VT-102 Text','VT');
INSERT INTO file_types (type, extension) VALUES ('GitHub Markdown Text','MD');
INSERT INTO file_types (type, extension) VALUES ('Rich Text File','RTF');
INSERT INTO file_types (type, extension) VALUES ('Information File','INF');
INSERT INTO file_types (type, extension) VALUES ('Configuration File','CFG');
INSERT INTO file_types (type, extension) VALUES ('Microsoft Word Document','DOC');
INSERT INTO file_types (type, extension) VALUES ('Microsoft Word Document','DOCX');
INSERT INTO file_types (type, extension) VALUES ('Perl Script','PL');
INSERT INTO file_types (type, extension) VALUES ('Perl Module','PM');
INSERT INTO file_types (type, extension) VALUES ('Python Script','PY');
INSERT INTO file_types (type, extension) VALUES ('C Source','C');
INSERT INTO file_types (type, extension) VALUES ('C++ Source','CPP');
INSERT INTO file_types (type, extension) VALUES ('C Include','H');
INSERT INTO file_types (type, extension) VALUES ('C-Shell Script','SH');
INSERT INTO file_types (type, extension) VALUES ('Cascading Style Sheet','CSS');
INSERT INTO file_types (type, extension) VALUES ('Hypter-Text Markup Language','HTM');
INSERT INTO file_types (type, extension) VALUES ('Hypter-Text Markup Language','HTML');
INSERT INTO file_types (type, extension) VALUES ('Javascript','JS');
INSERT INTO file_types (type, extension) VALUES ('Java Source','JAVA');

INSERT INTO file_types (type, extension) VALUES ('Portable Network Graphics Image','PNG');
INSERT INTO file_types (type, extension) VALUES ('JPEG Image','JPG');
INSERT INTO file_types (type, extension) VALUES ('CompuServe Graphics Interchange Format Image','GIF');
INSERT INTO file_types (type, extension) VALUES ('JPEG Image','JPEG');
INSERT INTO file_types (type, extension) VALUES ('Tagged Image File Format Image','TIFF');
INSERT INTO file_types (type, extension) VALUES ('Targa Image','TGA');
INSERT INTO file_types (type, extension) VALUES ('Image','WEBP');

INSERT INTO file_types (type, extension) VALUES ('MPEG 4 Video','MP4');
INSERT INTO file_types (type, extension) VALUES ('Matroska Packaged Video','MKV');
INSERT INTO file_types (type, extension) VALUES ('Audio Video Interchange Video','AVI');
INSERT INTO file_types (type, extension) VALUES ('MPEG 4 Video','MPV');
INSERT INTO file_types (type, extension) VALUES ('MPEG Video','MPG');
INSERT INTO file_types (type, extension) VALUES ('Motion JPEG Video','MJPG');

INSERT INTO file_types (type, extension) VALUES ('MPEG 2 Layer 3 Audio','MP3');
INSERT INTO file_types (type, extension) VALUES ('Advanced Audio Coding Audio','AAC');
INSERT INTO file_types (type, extension) VALUES ('Windows Audio','WAV');
INSERT INTO file_types (type, extension) VALUES ('Free Lossless Audio Compression Audio','FLAC');
INSERT INTO file_types (type, extension) VALUES ('Musical Instrument Digital Interface Audio','MID');
INSERT INTO file_types (type, extension) VALUES ('Tracker Audio','TRK');

INSERT INTO file_types (type, extension) VALUES ('Atari 400/800/XL/XE Disk Image','ATR')
INSERT INTO file_types (type, extension) VALUES ('Atari 400/800/XL/XE Binary Executable','XEX');
INSERT INTO file_types (type, extension) VALUES ('Atari ST/STE/TT/Falcon GEM Program','PRG');
INSERT INTO file_types (type, extension) VALUES ('Atari ST/STE/TT/Falcon TOS Program','TOS');
INSERT INTO file_types (type, extension) VALUES ('Atari ST/STE/TT/Falcon TOS Takes Parameters Program','TTP');
INSERT INTO file_types (type, extension) VALUES ('Atari ST/STE/TT/Falcon Desk Accessory','ACC');
INSERT INTO file_types (type, extension) VALUES ('Atari ST/STE/TT/Falcon Extenable Desk Accessory','CPX');

INSERT INTO file_types (type, extension) VALUES ('7Zip Compressed','7Z');
INSERT INTO file_types (type, extension) VALUES ('Zip Compressed','ZIP');
INSERT INTO file_types (type, extension) VALUES ('RAR Compressed','RAR');
INSERT INTO file_types (type, extension) VALUES ('Compressed Archive','ARC');
INSERT INTO file_types (type, extension) VALUES ('TAR Archive Compressed','TGZ');
INSERT INTO file_types (type, extension) VALUES ('TAR Archive','TAR');

INSERT INTO file_types (type, extension) VALUES ('Excel','XLS');
INSERT INTO file_types (type, extension) VALUES ('XML','XML');

